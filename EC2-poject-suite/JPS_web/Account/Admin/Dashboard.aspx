<%@ Page Language="C#" AutoEventWireup="true" MasterPageFile="~/Site.Master" CodeBehind="Dashboard.aspx.cs" Inherits="JPS_web.Account.Admin.Dashboard" %>

<asp:Content runat="server" ID="BodyContent" ContentPlaceHolderID="MainContent">

    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h4>Manage Customer's Bill</h4>
                <%-- <asp:GridView
                    ID="CustomersGridView"
                    runat="server"
                    CssClass="table table-hover table-bordered"
                    AutoGenerateColumns="False" DataKeyNames="Id"
                    ShowFooter="true" 
                    AutoGenerateDeleteButton="true"
                    AutoGenerateEditButton="true"
                    DataSourceID="BillsSqlDataSource"
                    AllowPaging="True">
                    <Columns>
                        <asp:TemplateField ShowHeader="False">
                            <ItemTemplate>
                                <asp:LinkButton runat="server" Text="Select" CommandName="Select" CausesValidation="False" ID="LinkButton1"></asp:LinkButton>
                            </ItemTemplate>
                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="Id" InsertVisible="False" SortExpression="Id">
                            <EditItemTemplate>
                                <asp:Label runat="server" Text='<%# Eval("Id") %>' ID="BillID"></asp:Label>
                            </EditItemTemplate>
                            <ItemTemplate>
                                <asp:Label runat="server" Text='<%# Bind("Id") %>' ID="BillID"></asp:Label>
                            </ItemTemplate>
                            <FooterTemplate>
                                <asp:LinkButton ID="lbInsert" runat="server">Insert</asp:LinkButton>
                            </FooterTemplate>
                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="GenerationDate" SortExpression="GenerationDate">
                            <EditItemTemplate>
                                <asp:TextBox runat="server" Text='<%# Bind("GenerationDate") %>' ID="GenerationDate"></asp:TextBox>
                            </EditItemTemplate>
                            <ItemTemplate>
                                <asp:Label runat="server" Text='<%# Bind("GenerationDate") %>' ID="GenerationDate"></asp:Label>
                            </ItemTemplate>
                            <FooterTemplate>
                                <asp:TextBox ID="txtGenerationDate" runat="server"></asp:TextBox>
                            </FooterTemplate>
                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="DueDate" SortExpression="DueDate">
                            <EditItemTemplate>
                                <asp:TextBox runat="server" Text='<%# Bind("DueDate") %>' ID="DueDate"></asp:TextBox>
                            </EditItemTemplate>
                            <ItemTemplate>
                                <asp:Label runat="server" Text='<%# Bind("DueDate") %>' ID="DueDate"></asp:Label>
                            </ItemTemplate>
                            <FooterTemplate>
                                <asp:TextBox ID="txtDueDate" runat="server"></asp:TextBox>
                            </FooterTemplate>
                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="PremisesNumber" SortExpression="PremisesNumber">
                            <EditItemTemplate>
                                <asp:TextBox runat="server" Text='<%# Bind("PremisesNumber") %>' ID="PremisesNumber"></asp:TextBox>
                            </EditItemTemplate>
                            <ItemTemplate>
                                <asp:Label runat="server" Text='<%# Bind("PremisesNumber") %>' ID="PremisesNumber"></asp:Label>
                            </ItemTemplate>
                            <FooterTemplate>
                                <asp:TextBox ID="txtPremisesNumber" runat="server"></asp:TextBox>
                            </FooterTemplate>
                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="Address" SortExpression="Address">
                            <EditItemTemplate>
                                <asp:TextBox runat="server" Text='<%# Bind("Address") %>' ID="Address"></asp:TextBox>
                            </EditItemTemplate>
                            <ItemTemplate>
                                <asp:Label runat="server" Text='<%# Bind("Address") %>' ID="Address"></asp:Label>
                            </ItemTemplate>
                            <FooterTemplate>
                                <asp:TextBox ID="txtAddress" runat="server"></asp:TextBox>
                            </FooterTemplate>
                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="Amount" SortExpression="Amount">
                            <EditItemTemplate>
                                <asp:TextBox runat="server" Text='<%# Bind("Amount") %>' ID="Amount"></asp:TextBox>
                            </EditItemTemplate>
                            <ItemTemplate>
                                <asp:Label runat="server" Text='<%# Bind("Amount") %>' ID="Amount"></asp:Label>
                            </ItemTemplate>
                            <FooterTemplate>
                                <asp:TextBox ID="txtAmount" runat="server"></asp:TextBox>
                            </FooterTemplate>
                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="CustomerId" SortExpression="CustomerId">
                            <EditItemTemplate>
                                <asp:DropDownList ID="ddlCustomerId" runat="server" DataSourceID="CurrentCustomersSqlDataSource" DataTextField="Id" DataValueField="Id" />
                            </EditItemTemplate>
                            <ItemTemplate>
                                <asp:Label runat="server" Text='<%# Bind("CustomerId") %>' ID="CustomerId"></asp:Label>
                            </ItemTemplate>
                            <FooterTemplate>
                                <asp:DropDownList ID="ddlCustomerId" runat="server" DataSourceID="CurrentCustomersSqlDataSource" DataTextField="Id" DataValueField="Id" />
                            </FooterTemplate>
                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="BillStatus_Id" SortExpression="BillStatus_Id">
                            <EditItemTemplate>
                                <asp:DropDownList ID="ddlBillStatus" runat="server" SelectedValue='<%# Bind("BillStatus_Id") %>'>
                                    <asp:ListItem>Select Bill Status</asp:ListItem>
                                    <asp:ListItem>Pending</asp:ListItem>
                                    <asp:ListItem>Paid</asp:ListItem>
                                </asp:DropDownList>
                            </EditItemTemplate>
                            <ItemTemplate>
                                <asp:Label runat="server" Text='<%# Bind("BillStatus_Id") %>' ID="BillStatus_Id"></asp:Label>
                            </ItemTemplate>
                            <FooterTemplate>
                                <asp:DropDownList ID="ddlBillStatus" runat="server">
                                    <asp:ListItem>Select Bill Status</asp:ListItem>
                                    <asp:ListItem>Pending</asp:ListItem>
                                    <asp:ListItem>Paid</asp:ListItem>
                                </asp:DropDownList>
                            </FooterTemplate>
                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="Transaction_Id" SortExpression="Transaction_Id">
                            <EditItemTemplate>
                                <asp:TextBox runat="server" Text='<%# Bind("Transaction_Id") %>' ID="Transaction_Id"></asp:TextBox>
                            </EditItemTemplate>
                            <ItemTemplate>
                                <asp:Label runat="server" Text='<%# Bind("Transaction_Id") %>' ID="Transaction_Id"></asp:Label>
                            </ItemTemplate>
                            <FooterTemplate>
                                <asp:TextBox ID="txtTransactionID" runat="server"></asp:TextBox>
                            </FooterTemplate>
                        </asp:TemplateField>
                    </Columns>
                </asp:GridView>
                <asp:SqlDataSource runat="server" ID="BillsSqlDataSource" ConnectionString='<%$ ConnectionStrings:DefaultConnection %>' SelectCommand="SELECT * FROM [Bills]"></asp:SqlDataSource>--%>
                <asp:ValidationSummary ShowModelStateErrors="true" runat="server" ForeColor="Red" />
                <br />
                <asp:Label runat="server" Text="Filter Bill Status:" />
                <asp:DropDownList runat="server" AutoPostBack="true" ID="DisplayBillStatus">
                    <asp:ListItem Text="All" Value="" />
                    <asp:ListItem Text="Pending" />
                    <asp:ListItem Text="Paid" />
                </asp:DropDownList>
                <asp:GridView
                    CssClass="table table-hover table-bordered"
                    UseAccessibleHeader="true"
                    GridLines="None"
                    ID="GridViewCustomerBill"
                    DataKeyNames="BillId"
                    AllowPaging="true"
                    PageSize="5"
                    ItemType="JPS_web.Models.Bill"
                    runat="server"
                    AutoGenerateColumns="false"
                    ShowFooter="false"
                    SelectMethod="CustomerBill_GetData"
                    UpdateMethod="CustomerBill_UpdateItem"
                    DeleteMethod="CustomerBill_DeleteItem"
                    AutoGenerateEditButton="true"
                    AutoGenerateDeleteButton="true">
                    <Columns>
                        <asp:DynamicField DataField="BillId" />
                        <asp:DynamicField DataField="Id" />
                        <asp:DynamicField DataField="BillGenerationDate" />
                        <asp:DynamicField DataField="BillDueDate" />
                        <asp:DynamicField DataField="PremisesNumber" />
                        <asp:DynamicField DataField="BillStatus" />
                        <asp:DynamicField DataField="Address" />
                        <asp:DynamicField DataField="Amount" />
                    </Columns>
                </asp:GridView>
                <br />
                <asp:HyperLink NavigateUrl="AddCustomerBill.aspx" Text="Add New Customer Bill" CssClass="btn btn-primary" runat="server" />
            </div>

            <div class="col-md-12">
                <h4>Current Customer's</h4>
                <asp:GridView ID="CurrentCustomersGridView" runat="server" CssClass="table table-hover table-bordered" AutoGenerateColumns="False" DataSourceID="CurrentCustomersSqlDataSource" AllowPaging="True">
                    <Columns>
                        <asp:BoundField DataField="Id" HeaderText="Id" SortExpression="Id"></asp:BoundField>
                        <asp:BoundField DataField="UserName" HeaderText="UserName" SortExpression="UserName"></asp:BoundField>
                        <asp:BoundField DataField="PremisesNumber" HeaderText="PremisesNumber" SortExpression="PremisesNumber"></asp:BoundField>
                    </Columns>
                </asp:GridView>
                <asp:SqlDataSource runat="server" ID="CurrentCustomersSqlDataSource" ConnectionString='<%$ ConnectionStrings:DefaultConnection %>' SelectCommand="SELECT * FROM [Customers]"></asp:SqlDataSource>
            </div>
        </div>
    </div>

</asp:Content>
